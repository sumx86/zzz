var globalSettings={"loader-ico":'<i class="fa fa-spinner fa-spin" id="spinner"></i>',"alert-exit":'<i id="exit-alert" class="fa fa-times"></i>',"psi-template":'<div class="psi"></div>',"psi-states":{fail:0,close:1,done:2},"color-panel":{template:'<div id="color-panel" data-cl></div>',palette:'<div class="palette" data-cl><div class="inner" data-cl></div></div>',palettes:["6f62a1","564691","556b2f","ededed","bababa","5f7fad","405c85","59383a","5c2c2e","3b736e"]},ajax:{login:"/ajax/login",register:"/ajax/register","reset-pass":"/ajax/reset-pass",search:"/ajax/search",update:"/ajax/update"},routes:{home:"/",acc:"/account",forum:"/forum",members:"/members",sign:"/sign"}},SimpleModalEvents={init:function(t){$(document).on("click",t.trigger,t.handle),$._on(document,null,{keydown:function(i){"escape"==i.key.toLowerCase()&&$(t.target).hasClass("modal-active")&&$(t.trigger).click()},click:function(i){var e=i.target;$(t.target).hasClass("modal-active")&&!e.hasAttribute(t.uniq_d)&&$(t.trigger).click()}},null)}};!function(t){t.extend(jQuery,{initCall:function(i,e){t.isFunction(e.initialize)&&(e.initialize.call(e),i&&console.log("Running initialize function of: '"+i+"' object"))},cancelEvent:function(i){i.preventDefault(),t.isFunction(i.stopPropagation)&&i.stopPropagation(),i.hasOwnProperty("cancelBubble")&&(i.cancelBubble=!0)},_on:function(i,e,n,a){var o=t.type(n);if("object"!=o)throw new TypeError("[jQuery._on()] Expected third argument of type `object`, `"+o+"` was passed instead.");t.each(n,function(n,o){o=a?o.bind(a):o,e&&t(i).on(n,e,o)||t(i).on(n,o)})},doAjax:function(i,e,n){var a=t.extend({url:"",async:!0,data:{},type:"post"},i);return e&&null!=n&&null!=n&&ui.loaderShow(n.parent()),t.ajax(a)}}),t._isMobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},t.setHoverable=function(i){t._on(i,null,{mouseenter:function(i){t(i.currentTarget).addClass("hoverable")},mouseleave:function(i){t(i.currentTarget).removeClass("hoverable")}},null)},t.redirect=function(t){var i;return i="object"==typeof t?globalSettings.routes[t.getAttribute("data-name")]:t,(window.location.href=i)||window.location.assign(i)||window.location.replace(i)}}(jQuery),function(t){t.corePlugin=t.corePlugin||{},t.corePlugin.alert=t.corePlugin.alert||{},t.corePlugin.alert.callbacks={},t.corePlugin.alert.self=null,t.corePlugin.alert.show=function(t,i){this.init(t,i.callback)},t.corePlugin.alert.init=function(i,e){var n="<div id='alert-box'><div id='alert-box-text-box'><span id='text'>"+i+"</span></div><button id='alert-box-button' data-action='ok'>OK</button></div>";this.self=t(t.parseHTML(n)[0]),t("body").find("div:first").append(this.self),this.callbacks.ok=e.ok,this.setup()},t.corePlugin.alert.setup=function(){var i=this;this.self.on("click","[data-action]",this._click),t(document).keydown(function(t){"escape"!=t.key.toLowerCase()&&"enter"!=t.key.toLowerCase()||i.self.find("[data-action]").focus().click()})},t.corePlugin.alert._click=function(i){t.corePlugin.alert.callbacks.ok()}}(jQuery),function(t){t(document).ready(function(){t(".lang").click(function(){cookieUtil.create({name:"lang",value:t(this).find("span").text().toLowerCase(),path:"/",days:365}),location=location.href}),cookieUtil.get("logo-tooltip")?t(".logo-tooltip").css("display","none"):(t(".logo-tooltip").css("display","inline-block"),t(".hide-tooltip").click(function(i){cookieUtil.create({name:"logo-tooltip",value:"1",path:location.href,days:365}),t(".logo-tooltip").css("display","none")}))})}(jQuery),function(t){t.initCall("",{initialize:function(){t(document).on("click","[data-redirect]",this._doRedirect)},_doRedirect:function(i){var e=i.currentTarget;t.redirect(e)}})}(jQuery),function(t){t.initCall("logo-handling",{_logoContainer:"#root-logo-container",_panelId:"color-panel",_paletteClass:".palette",_panelInitialized:!1,_parentContainer:"#main-container-top-wrapper",_panel:null,initialize:function(){SimpleModalEvents.init({target:"#color-panel",trigger:'[data-role="show-color-panel"]',uniq_d:"data-cl",handle:this._toggleColorPanel.bind(this)})},_init:function(){this._panel=t(t.parseHTML(globalSettings["color-panel"].template)[0]),this._setup(),t(this._parentContainer).append(this._panel),this._panelInitialized=!0,this._toggle()},_setup:function(){var i=this;t.each(globalSettings["color-panel"].palettes,function(t,e){i._addPaletteElement(e)}),this._panel.find(this._paletteClass).each(function(e,n){var a=t(n),o=a.attr("data-color");a.click(function(){cookieUtil.create({name:"logo-color",value:o,path:location.href,days:365}),t(i._logoContainer).find("a:first").css("color",o)})})},_addPaletteElement:function(i){var e=t(t.parseHTML(globalSettings["color-panel"].palette)[0]);i="#"+i;e.attr("data-color",i),e.find(".inner:first").css("background-color",i),this._panel.append(e)},_toggleColorPanel:function(){this._panelInitialized?this._toggle():this._init()},_toggle:function(){this._isActive()?(this._panel.stop().fadeOut(200),this._panel.removeClass("modal-active")):(this._panel.stop().fadeIn(200),this._panel.addClass("modal-active"))},_isActive:function(){return this._panel.hasClass("modal-active")}})}(jQuery),function(t){t.initCall("user-settings",{_modal:"#settings-container",_data:null,initialize:function(){t(document).ready(function(){t("#sign-out-button").click(function(i){t.redirect("/ajax/logout")})}),SimpleModalEvents.init({target:"#settings-container",trigger:"#user-settings-button",uniq_d:"data-gr",handle:this._toggleModal.bind(this)})},_toggleModal:function(i){var e=t(this._modal);this._isActive()?(e.stop().fadeOut(200),e.removeClass("modal-active")):(e.stop().fadeIn(200),e.addClass("modal-active"))},_isActive:function(){return t(this._modal).hasClass("modal-active")}})}(jQuery),function(t){t.initCall("update-user-info",{_editor:".info-edit-block",_active:!1,initialize:function(){t(document).on("click",'[data-role="edit-user-info"]',this._toggleContentEditor.bind(this)),t(document).on("click",'[data-role="update-user"]',this._update.bind(this)),t(document).on("user-info-update",this.updateContent.bind(this))},_toggleContentEditor:function(i){if(this._isActiveModal()){var e=this;t(this._editor).find("#inner > #content").hide("fast"),setTimeout(function(){t(e._editor).find("#inner").stop().animate({height:"0px"},"fast"),e._active=!1},200)}else t(this._editor).find("#inner > #content").show("fast"),t(this._editor).find("#inner").stop().animate({height:"420px"}),this._active=!0},_getInputData:function(){var i={accounts:{}};return t(".info-field").each(function(e,n){let a=n.getAttribute("name");("account-list-item"==n.getAttribute("data-role")?i.accounts:i)[a]=t(n).val()}),i},_update:function(i){var e=t(i.currentTarget);this._toggleSubmitLock();t.doAjax({url:globalSettings.ajax[e.attr("data-action")],data:JSON.stringify(this._getInputData())+"user-info-update"},!0,e).done(function(i,n,a){var o=t.parseJSON(i);t(document).trigger("user-info-update",[{response:o,target:e}])}).fail(function(i){t.corePlugin.alert.show(i,{callback:{ok:function(){t.redirect(window.location.href)}}},!0)})},updateContent:function(t,i){console.log(i),ui.loaderHide(i.target.parent()),this._toggleSubmitLock()},_toggleSubmitLock:function(){t('[data-role="update-user"]').prop("disabled",function(t,i){return!i})},_isActiveModal:function(){return this._active}})}(jQuery),function(t){t.initCall("form-handling",{initialize:function(){t(window).on("load",this._initializeInputErrors.bind(this)),t._on(document,"#sign-in-form, #sign-up-form, #reset-pass-form",{submit:this._formSubmit},this)},_initializeInputErrors:function(){t(".input-field").each(function(i,e){var n=t(this),a=n.parent().parent();if(t.inArray(a.attr("data-action"),["login","register","reset-pass"])){var o=t.parseHTML("<span style='display: none;'>what teh cuck</span>");t(o).attr("id",n.attr("name")+"-error"),a.append(o)}})},_formSubmit:function(i){t.cancelEvent(i);var e=t(i.currentTarget);this._toggleSubmitLock(),this._resetInputFields(e);var n=this;t.doAjax({url:globalSettings.ajax[e.attr("data-action")],data:e.serialize()},!0,e).done(function(i,a,o){if(console.log(i),0==i.indexOf("{")){var l=t.parseJSON(i);l.hasOwnProperty("success")?t.redirect(globalSettings.routes.home):n._handleError(l["input-error"])}ui.loaderHide(e.parent()),n._toggleSubmitLock()}).fail(function(i){t.corePlugin.alert.show(i,{callback:{ok:function(){t.redirect(window.location.href)}}},!0)})},_toggleSubmitLock:function(){t(document).find("[data-action='sign']").each(function(i,e){t(e).find("button").prop("disabled",function(t,i){return!i})})},_handleError:function(i){t.each(i,function(i,e){t("input[name='"+i+"']").css("border","1px solid #c3382e").addClass("error"),""!=e&&t("#"+i+"-error").css("display","block").text(e)})},_resetInputFields:function(i){i.find("input").each(function(i,e){t(e).css("border","1px solid #2a3232").removeClass("error"),t("#"+t(e).attr("name")+"-error").text("")})}})}(jQuery),function(t){t.initCall("password-strength-indicator",{_pollInterval:100,_checkTimer:null,_tooltip:"#psi-tooltip",_passwordField:'input[type="password"]',initialize:function(){var i=this;t(window).on("load",function(){t._on(i._passwordField,null,{focus:i._pollInit,blur:i._pollEnd},i)})},_pollInit:function(i){var e=t(i.target);if(e.attr("data-psi")){var n=e.attr("data-psi");this._pollField({field:e,psi:n})}},_pollField:function(t){this._checkTimer=setInterval(this._check,this._pollInterval,t,this),this.showTooltip()},_pollEnd:function(t){this._checkTimer&&clearInterval(this._checkTimer),this.hideTooltip()},showTooltip:function(){t(this._tooltip).stop().fadeIn("fast")},hideTooltip:function(){t(this._tooltip).stop().fadeOut("fast")},psiIndicator:{initialized:!1,psi:"",_state:-1,init:function(){this.setup(t(this.psi),globalSettings["psi-template"]),this.initialized=!0},clearValues:function(){this.initialized=!1,this.psi="",console.log("Psi indicator terminated!")},setup:function(t,i){t.find(".psi").length<=0&&(t.append(i),t.append(i),t.append(i))},render:function(t){this.initialized||(this.init(),console.log("Psi indicator initialized! [psi-container="+this.psi+"] [initial-state="+this._state+"]")),this.updatePsi(t)},updatePsi:function(i){var e=this.getStateName(i),n=t(this.psi),a=this,o=n.find(".psi");this.onStateChanged(i,function(){var t=i+1;o.slice(0,t).map(function(t,i){a.setState(i,e)}),a.removePrevious(t,o)})},removePrevious:function(i,e){i<e.length&&e.slice(i,e.length).map(function(i,e){t(e).attr("class","psi")})},onStateChanged:function(t,i){this._state!=t&&(this._state=t,i())},getStateName:function(t){var i=globalSettings["psi-states"];for(var e in i)if(i[e]===t)return e},setState:function(i,e){t(i).attr("class","psi psi-state-"+e)},setPsi:function(t){this.psi=t},hasPsi:function(){return""!=this.psi}},_check:function(t,i){var e,n=t.field.val();n.length<15?e=globalSettings["psi-states"].fail:n.length>=15&&(e=/[0-9]/.test(n)&&/[A-Z]/.test(n)?globalSettings["psi-states"].done:globalSettings["psi-states"].close),i.psiIndicator.hasPsi()||i.psiIndicator.setPsi("#"+t.psi),i.psiIndicator.render(e)}})}(jQuery);